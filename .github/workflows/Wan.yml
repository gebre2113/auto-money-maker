name: Profit Master Supreme - EXECUTE

on:
  schedule:
    - cron: '0 */6 * * *'  # á‰ á‹¨ 6 áˆ°á‹“á‰± á‰ áˆ«áˆ± á‹­áˆ°áˆ«áˆ
  workflow_dispatch:       # áŠ áŠ•á‰° á‰ áˆáˆˆáŒáŠ­ áˆ°á‹“á‰µ "Run" á‰¥áˆˆáˆ… áˆ›áˆµáŒ€áˆ˜áˆ­ á‰µá‰½áˆ‹áˆˆáˆ…
    inputs:
      topic:
        description: 'á‹¨á‹­á‹˜á‰µ áˆ­á‹•áˆµ (Topic)'
        required: false
        default: 'AI Revolution'
      language:
        description: 'á‰‹áŠ•á‰‹ (am/en)'
        required: false
        default: 'am'

permissions:
  contents: write

jobs:
  run_profit_master:
    name: "ğŸš€ Run Profit Master System"
    runs-on: ubuntu-latest
    
    steps:
      # 1. á‹«áŠ•á‰°áŠ• áŠ®á‹µ áŠ¨ GitHub á‹«á‹ˆáˆ­á‹°á‹‹áˆ
      - name: "ğŸ“¥ Checkout Repository"
        uses: actions/checkout@v4

      # 2. Python 3.12 á‹«á‹˜áŒ‹áŒƒáˆ
      - name: "ğŸ Setup Python 3.12"
        uses: actions/setup-python@v5
        with:
          python-version: '3.12'
          cache: 'pip'

      # 3. á‹¨á‰ªá‹µá‹® áˆ˜áˆµáˆ«á‰µ á‹¨áˆšá‹«áˆµáˆáˆáŒˆá‹áŠ• FFmpeg á‹­áŒ­áŠ“áˆ
      - name: "ğŸ”§ Install FFmpeg"
        run: |
          sudo apt-get update
          sudo apt-get install -y ffmpeg

      # 4. á‹¨áˆ˜áˆ áˆ¨á‰µ Python áˆŠá‰¥áˆ¨áˆªá‹á‰½áŠ• á‰¥á‰» á‹­áŒ­áŠ“áˆ (áŠ®á‹µáˆ… áˆŒáˆá‰¹áŠ• á‰ áˆ«áˆ± á‹­áŒ­áŠ“áˆ)
      - name: "ğŸ“¦ Install Base Python Libraries"
        run: |
          pip install --upgrade pip
          # áˆ˜áˆ áˆ¨á‰³á‹Š áˆŠá‰¥áˆ¨áˆªá‹á‰½ á‰¥á‰»
          pip install requests pandas numpy

      # 5. á‹«áŠ•á‰°áŠ• á‰µáˆá‰áŠ• áˆµáŠ­áˆªá•á‰µ á‹«áˆµáŠ¬á‹³áˆ (áŠ®á‹µáˆ… áˆŒáˆá‰¹áŠ• áˆŠá‰¥áˆ¨áˆªá‹á‰½ á‰ áˆ«áˆ± á‹­áŒ­áŠ“áˆ)
      - name: "ğŸ¤– Execute Your Script"
        env:
          # áŠ¥áŠá‹šáˆ…áŠ• á‰áˆáá‰½ á‰  GitHub Settings -> Secrets á‹áˆµáŒ¥ áˆ›áˆµáŒˆá‰£á‰µ áŠ áˆˆá‰¥áˆ…
          GROQ_API_KEY: ${{ secrets.GROQ_API_KEY }}
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: |
          echo "ğŸš€ Starting Profit Master System..."
          
          # áˆµáŠ­áˆªá•á‰µáˆ… áŠ áˆˆáˆ˜áŠ–áˆ©áŠ• áˆ›áˆ¨áŒ‹áŒˆáŒ«
          if [ -f "main.py" ]; then
             # áŠ®á‹µáˆ… áˆŠá‰¥áˆ¨áˆªá‹á‰¹áŠ• á‰ áˆ«áˆ± á‹­áŒ­áŠ“áˆá£ áˆµáˆˆá‹šáˆ… á‹«áˆˆ áˆ›áŒˆáŒƒ áˆ›áˆµáŠ¬á‹µ
             python main.py --topic "${{ github.event.inputs.topic || 'Future AI' }}" --language "${{ github.event.inputs.language || 'am' }}"
          else
             echo "âŒ Error: main.py á‹á‹­áˆ áŠ áˆá‰°áŒˆáŠ˜áˆ!"
             exit 1
          fi

      # 6. á‹áŒ¤á‰±áŠ• (á‹¨á‰°áˆáŒ áˆ© á‹á‹­áˆá‰½áŠ•) á‹«áˆµá‰€áˆáŒ£áˆ
      - name: "ğŸ’¾ Upload Results"
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: profit-master-results
          path: |
            profit_master.log
            generated_content/
            output/
            *.json
            *.html
            *.txt
          retention-days: 5
