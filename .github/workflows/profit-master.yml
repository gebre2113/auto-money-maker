name: Profit Master Supreme - ULTIMATE MODE

on:
  schedule:
    - cron: '0 */6 * * *'  # ·â†·ã® 6 ·à∞·ãì·â±
    - cron: '0 12 * * *'   # ·â†·ã®·âÄ·äë ·ä•·ä©·àà ·à∞·ãì·âµ
    - cron: '0 18 * * *'   # ·â†·ã®·âÄ·äë 6:00 PM UTC
    
  workflow_dispatch:
    inputs:
      mode:
        description: '·àõ·àµ·ä¨·ãµ ·àû·ãµ'
        required: true
        default: 'full-auto'
        type: choice
        options:
          - full-auto
          - content-only
          - affiliate-only
          - social-media
          - emergency-fix
      topic:
        description: '·ã®·ã≠·ãò·âµ ·à≠·ãï·àµ'
        required: false
        default: 'AI ·ä•·äì ·ãµ·à≠·à∞·âµ ·àõ·àΩ·äï'
        type: string
      language:
        description: '·âã·äï·âã'
        required: false
        default: 'am'
        type: choice
        options:
          - am
          - en
          - es
          - fr

permissions:
  contents: write
  pages: write
  id-token: write
  actions: write

env:
  PYTHON_VERSION: '3.12'
  WORKING_DIR: '/opt/profit_master'
  DB_PATH: '/opt/profit_master/data/profit_master.db'
  LOG_FILE: '/opt/profit_master/logs/system.log'
  OUTPUT_DIR: '/opt/profit_master/public'
  
  # AI ·âÖ·äï·â•·àÆ·âΩ
  AI_MODEL: 'groq:llama-3.3-70b-versatile'
  MAX_RETRIES: '5'
  QUALITY_THRESHOLD: '85'
  MIN_CONTENT_LENGTH: '2000'
  
  # ·ã®·àõ·àµ·â∞·ãã·ãà·âÇ·ã´ ·âÖ·äï·â•·àÆ·âΩ
  TELEGRAM_ENABLED: 'true'
  SAVE_TO_GITHUB: 'true'
  GENERATE_DASHBOARD: 'true'
  UPLOAD_TO_CLOUD: 'false'

jobs:
  system_initialization:
    runs-on: ubuntu-latest
    name: "‚öôÔ∏è ·àµ·à≠·ãì·âµ ·àò·åÄ·àò·à≠"
    outputs:
      session_id: ${{ steps.generate_id.outputs.session_id }}
      start_time: ${{ steps.generate_id.outputs.start_time }}
    
    steps:
      - name: "üîÑ ·à¨·çñ·ãö·â∂·à™ ·àõ·ãç·à®·ãµ"
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          token: ${{ secrets.GITHUB_TOKEN }}
          
      - name: "üîß ·àµ·à≠·ãì·âµ ·àò·àà·ã´ ·àò·çç·å†·à≠"
        id: generate_id
        run: |
          SESSION_ID="PM_$(date +%Y%m%d_%H%M%S)_${{ github.run_id }}"
          START_TIME=$(date -u +"%Y-%m-%dT%H:%M:%SZ")
          echo "session_id=${SESSION_ID}" >> $GITHUB_OUTPUT
          echo "start_time=${START_TIME}" >> $GITHUB_OUTPUT
          echo "SESSION_ID=${SESSION_ID}" >> $GITHUB_ENV
          echo "SYSTEM_VERSION=15.1" >> $GITHUB_ENV
          
      - name: "üìÅ ·ã®·à•·à´ ·àò·ãã·âÖ·à≠ ·àò·çç·å†·à≠"
        run: |
          sudo mkdir -p /opt/profit_master
          sudo chown -R $USER:$USER /opt/profit_master
          
          mkdir -p /opt/profit_master/{data,logs,reports,public,temp,cache}
          mkdir -p /opt/profit_master/public/{articles,videos,audio,images,tables,affiliate,dashboard}
          
          echo "üìÅ ·ã®·à•·à´ ·àò·ãã·âÖ·à≠ ·â∞·çà·å•·àØ·àç"
          
      - name: "üóÑÔ∏è ·ã®·ãç·àÇ·â• ·åé·â≥ ·àò·åÄ·àò·à≠"
        run: |
          cat > /opt/profit_master/data/init_db.py << 'EOF'
          import sqlite3, os, json, time
          from datetime import datetime
          
          DB_PATH = "/opt/profit_master/data/profit_master.db"
          
          # ·ã®·ãç·àÇ·â• ·åé·â≥ ·àò·çç·å†·à≠
          conn = sqlite3.connect(DB_PATH)
          cursor = conn.cursor()
          
          # ·àµ·à≠·ãì·âµ ·àé·åé·âΩ ·à∞·äï·å†·à®·ã•
          cursor.execute('''
          CREATE TABLE IF NOT EXISTS system_logs (
              id INTEGER PRIMARY KEY AUTOINCREMENT,
              session_id TEXT,
              operation TEXT,
              status TEXT,
              message TEXT,
              timestamp DATETIME DEFAULT CURRENT_TIMESTAMP
          )
          ''')
          
          # ·ã®·ã≠·ãò·âµ ·à∞·äï·å†·à®·ã•
          cursor.execute('''
          CREATE TABLE IF NOT EXISTS generated_content (
              content_id TEXT PRIMARY KEY,
              title TEXT,
              topic TEXT,
              language TEXT,
              word_count INTEGER,
              quality_score REAL,
              seo_score REAL,
              monetized BOOLEAN,
              affiliate_count INTEGER,
              created_at DATETIME,
              file_path TEXT,
              telegram_sent BOOLEAN DEFAULT 0
          )
          ''')
          
          # ·ã®·åà·â¢ ·à∞·äï·å†·à®·ã•
          cursor.execute('''
          CREATE TABLE IF NOT EXISTS revenue_tracking (
              id INTEGER PRIMARY KEY AUTOINCREMENT,
              session_id TEXT,
              content_id TEXT,
              affiliate_product TEXT,
              commission_amount REAL,
              estimated_earning REAL,
              status TEXT,
              timestamp DATETIME DEFAULT CURRENT_TIMESTAMP
          )
          ''')
          
          # ·ã®·àõ·àÖ·â†·à´·ãä ·àö·ã≤·ã´ ·à∞·äï·å†·à®·ã•
          cursor.execute('''
          CREATE TABLE IF NOT EXISTS social_media_posts (
              id INTEGER PRIMARY KEY AUTOINCREMENT,
              platform TEXT,
              content_id TEXT,
              post_text TEXT,
              status TEXT,
              link TEXT,
              timestamp DATETIME DEFAULT CURRENT_TIMESTAMP
          )
          ''')
          
          # ·ã®·àµ·à´ ·àµ·â≥·â≤·àµ·â≤·ä≠·àµ
          cursor.execute('''
          CREATE TABLE IF NOT EXISTS job_statistics (
              id INTEGER PRIMARY KEY AUTOINCREMENT,
              session_id TEXT,
              operation TEXT,
              duration_seconds REAL,
              success_count INTEGER,
              failure_count INTEGER,
              total_earning REAL,
              timestamp DATETIME DEFAULT CURRENT_TIMESTAMP
          )
          ''')
          
          # ·ã®·àò·åÄ·àò·à™·ã´ ·àò·ãù·åà·â•
          cursor.execute('''
          INSERT INTO system_logs (session_id, operation, status, message)
          VALUES (?, ?, ?, ?)
          ''', (os.getenv('SESSION_ID'), 'init', 'success', 'System initialized successfully'))
          
          conn.commit()
          conn.close()
          
          print("‚úÖ ·ã®·ãç·àÇ·â• ·åé·â≥ ·â∞·çà·å•·àØ·àç (4 tables)")
          EOF
          
          python3 /opt/profit_master/data/init_db.py

  setup_environment:
    needs: system_initialization
    runs-on: ubuntu-latest
    name: "üêç ·ä†·ä´·â£·â¢ ·ä†·à∞·äì·ä®·àç"
    
    steps:
      - name: "üîÑ ·à¨·çñ·ãö·â∂·à™ ·àõ·ãç·à®·ãµ"
        uses: actions/checkout@v4
        
      - name: "üêç Python 3.12 ·ä†·à∞·äì·ä®·àç"
        uses: actions/setup-python@v5
        with:
          python-version: ${{ env.PYTHON_VERSION }}
          cache: 'pip'
          
      - name: "üîß ·àµ·à≠·ãì·âµ ·àò·à£·à™·ã´·ãé·âΩ ·àò·å´·äï"
        run: |
          sudo apt-get update
          sudo apt-get install -y \
            ffmpeg \
            imagemagick \
            libmagic-dev \
            python3-dev \
            python3-pip \
            python3-venv \
            redis-server \
            sqlite3 \
            curl \
            wget \
            git \
            jq \
            zip \
            unzip
            
          # ·à™·ã≤·àµ ·ä†·åà·àç·åç·àé·âµ ·àõ·àµ·åÄ·àò·à≠
          sudo systemctl start redis
          sudo systemctl enable redis
          
      - name: "üì¶ ·ä†·àµ·çà·àã·åä ·å•·åà·äõ·ãé·âΩ ·àò·å´·äï"
        run: |
          cd /opt/profit_master
          
          # ·ã®·å•·åà·äù·äê·âµ ·çã·ã≠·àç ·àò·çç·å†·à≠
          cat > requirements.txt << 'EOF'
          # Core dependencies
          aiohttp>=3.9.0
          httpx>=0.25.0
          pandas>=2.0.0
          numpy>=1.24.0
          requests>=2.31.0
          schedule>=1.2.0
          plotly>=5.18.0
          
          # AI/ML libraries
          groq>=0.3.0
          google-generativeai>=0.3.0
          openai>=0.28.0
          anthropic>=0.7.0
          cohere>=4.0.0
          transformers>=4.35.0
          torch>=2.1.0
          torchvision>=0.16.0
          torchaudio>=2.1.0
          
          # Content generation
          gtts>=2.3.0
          moviepy>=1.0.3
          pytube>=15.0.0
          yt-dlp>=2023.10.13
          Pillow>=10.0.0
          python-docx>=0.8.11
          reportlab>=4.0.0
          
          # Web & automation
          beautifulsoup4>=4.12.0
          lxml>=4.9.0
          selenium>=4.15.0
          webdriver-manager>=4.0.0
          
          # Social media APIs
          tweepy>=4.14.0
          facebook-sdk>=4.0.0
          python-telegram-bot>=20.0
          discord-webhook>=1.0.0
          linkedin-api>=2.0.0
          
          # Database & storage
          sqlalchemy>=2.0.0
          redis>=5.0.0
          psycopg2-binary>=2.9.0
          boto3>=1.34.0
          
          # NLP & text processing
          nltk>=3.8.0
          spacy>=3.7.0
          textblob>=0.17.1
          langdetect>=1.0.9
          sumy>=0.11.0
          
          # Web framework
          fastapi>=0.104.0
          uvicorn>=0.24.0
          pydantic>=2.4.0
          streamlit>=1.28.0
          
          # Utilities
          prometheus-client>=0.19.0
          python-dotenv>=1.0.0
          loguru>=0.7.2
          colorama>=0.4.6
          tqdm>=4.66.0
          python-multipart>=0.0.6
          
          # Development tools
          pytest>=7.4.0
          black>=23.0.0
          flake8>=6.1.0
          mypy>=1.7.0
          EOF
          
          # ·å•·åà·äõ·ãé·âΩ ·àò·å´·äï
          pip install --upgrade pip setuptools wheel
          pip install -r requirements.txt --no-cache-dir
          
          # spaCy ·àû·ã¥·àç
          python -m spacy download en_core_web_sm
          
          # NLTK ·ãç·àÇ·â•
          python -m nltk.downloader punkt stopwords wordnet averaged_perceptron_tagger
          
          echo "‚úÖ ·àÅ·àâ·àù ·å•·åà·äõ·ãé·âΩ ·â∞·å´·äë"
          
      - name: "üîç ·äÆ·ã±·äï ·ãà·ã∞ ·à•·à´ ·â¶·â≥ ·àò·åà·àç·â†·å•"
        run: |
          cp -r $GITHUB_WORKSPACE/* /opt/profit_master/ 2>/dev/null || true
          
          # ·ãã·äì·ãç·äï ·çã·ã≠·àç ·àò·çà·â∞·àΩ
          if [ ! -f "/opt/profit_master/main.py" ]; then
            echo "‚ùå ·ãã·äì ·çã·ã≠·àç ·ä†·àç·â∞·åà·äò·àù! ·ã®·àô·ä®·à´ ·çã·ã≠·àç ·ä•·à∞·à´·àà·àÅ..."
            
            cat > /opt/profit_master/main.py << 'EOF'
          """
          üöÄ PROFIT MASTER SUPREME - ULTIMATE AI CONTENT SYSTEM
          ·ã®·â∞·àü·àã ·ã®AI ·ã≠·ãò·âµ ·çç·å†·à≠·ç£ ·àô·àç·â≤·àö·ã≤·ã´ ·àõ·àª·àª·àç ·ä•·äì ·ä†·çä·àä·ã¨·âµ ·àû·äî·â≥·ã≠·ãú·àΩ·äï ·àµ·à≠·ãì·âµ
          """
          
          import os
          import sys
          import json
          import time
          import random
          import logging
          import hashlib
          import asyncio
          import sqlite3
          from datetime import datetime, timedelta
          from typing import Dict, List, Optional, Any
          import requests
          import pandas as pd
          
          # Configure logging
          logging.basicConfig(
              level=logging.INFO,
              format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
              handlers=[
                  logging.FileHandler('/opt/profit_master/logs/system.log'),
                  logging.StreamHandler()
              ]
          )
          
          logger = logging.getLogger(__name__)
          
          class UltimateProfitMaster:
              def __init__(self, session_id: str):
                  self.session_id = session_id
                  self.db_path = "/opt/profit_master/data/profit_master.db"
                  self.output_dir = "/opt/profit_master/public"
                  self.logger = logger
                  
                  # Create directories
                  os.makedirs(self.output_dir, exist_ok=True)
                  
                  self.logger.info(f"üöÄ Profit Master Supreme initialized: {session_id}")
              
              def log_to_db(self, operation: str, status: str, message: str):
                  """·àà·ãç·àÇ·â• ·åé·â≥ ·àé·åç ·àò·åª·çç"""
                  try:
                      conn = sqlite3.connect(self.db_path)
                      cursor = conn.cursor()
                      cursor.execute('''
                          INSERT INTO system_logs (session_id, operation, status, message)
                          VALUES (?, ?, ?, ?)
                      ''', (self.session_id, operation, status, message))
                      conn.commit()
                      conn.close()
                  except Exception as e:
                      self.logger.error(f"Database log failed: {e}")
              
              async def generate_ai_content(self, topic: str, language: str = "am") -> Dict:
                  """AI ·â†·àò·å†·âÄ·àù ·ã≠·ãò·âµ ·çç·å†·à≠"""
                  try:
                      self.logger.info(f"ü§ñ ·ã≠·ãò·âµ ·àò·çç·å†·à≠ ·ä•·ã®·åÄ·àò·à® ·äê·ãç: {topic}")
                      
                      # Simulate AI content generation
                      content_id = f"content_{hashlib.md5(f'{topic}{datetime.now()}'.encode()).hexdigest()[:10]}"
                      
                      if language == "am":
                          title = f"{topic}: ·àô·àâ ·àò·àò·à™·ã´ ·ä•·äì ·àõ·åç·äò·âµ ·ã®·àö·âΩ·àâ·â†·âµ ·àò·äï·åà·ãµ"
                          content = f"""
                          <h1>{title}</h1>
                          
                          <h2>·àà·àù·äï {topic} ·ä†·àµ·çà·àã·åä ·äê·ãç?</h2>
                          <p>·â†·ãò·àò·äì·ãä·ãç ·ãì·àà·àù·ç£ {topic} ·ä®·çç·â∞·äõ ·ä†·àµ·çà·àã·åä·äê·âµ ·ä†·àà·ãç·ç¢ ·ã≠·àÖ ·àò·àò·à™·ã´ ·àÅ·àâ·äï·àù ·ãù·à≠·ãù·à≠ ·ã´·âÄ·à≠·â£·àç·ç¢</p>
                          
                          <h2>·ãã·äì ·ãã·äì ·å•·âÖ·àû·âΩ</h2>
                          <ul>
                          <li>·ä®·çç·â∞·äõ ·åà·â¢ ·àõ·àò·äï·å®·âµ</li>
                          <li>·åä·ãú·äï ·â†·å•·â†·â• ·àò·å†·âÄ·àù</li>
                          <li>·ã®·â¥·ä≠·äñ·àé·åÇ ·ä•·ãµ·åà·âµ·äï ·àò·ä®·â∞·àç</li>
                          <li>·ã®·ãç·ãµ·ãµ·à≠ ·å•·âÖ·àù ·àõ·åç·äò·âµ</li>
                          </ul>
                          
                          <h2>·ã∞·à®·åÉ ·â†·ã∞·à®·åÉ ·àò·àò·à™·ã´</h2>
                          <ol>
                          <li>·àò·à∞·à®·â≥·ãä ·çÖ·äï·à∞ ·àÄ·à≥·â¶·âΩ·äï ·àõ·ãà·âÖ</li>
                          <li>·â∞·åà·â¢ ·àò·à≥·à™·ã´·ãé·âΩ·äï ·àò·àù·à®·å•</li>
                          <li>·â∞·åç·â£·à´·ãä ·àõ·àµ·çà·çÄ·àö·ã´</li>
                          <li>·ãç·å§·âµ·äï ·àò·ä®·â≥·â∞·àç</li>
                          </ol>
                          
                          <h2>·àõ·å†·âÉ·àà·ã´</h2>
                          <p>{topic} ·â†·âµ·ä≠·ä≠·àç ·à≤·â∞·åà·â†·à≠ ·â≥·àã·âÖ ·àà·ãç·å• ·àä·ã´·àò·å£ ·ã≠·âΩ·àã·àç·ç¢ ·ãõ·à¨ ·àò·åÄ·àò·à≠ ·ã≠·âΩ·àã·àâ!</p>
                          """
                      else:
                          title = f"The Complete Guide to {topic} in 2024"
                          content = f"""
                          <h1>{title}</h1>
                          
                          <h2>Why {topic} Matters</h2>
                          <p>In today's digital world, {topic} is essential for success. This guide covers everything.</p>
                          
                          <h2>Key Benefits</h2>
                          <ul>
                          <li>Generate substantial income</li>
                          <li>Save time with automation</li>
                          <li>Stay ahead with technology</li>
                          <li>Gain competitive advantage</li>
                          </ul>
                          
                          <h2>Step-by-Step Implementation</h2>
                          <ol>
                          <li>Understand basic concepts</li>
                          <li>Choose the right tools</li>
                          <li>Implement practically</li>
                          <li>Monitor results</li>
                          </ol>
                          
                          <h2>Conclusion</h2>
                          <p>{topic} can transform your workflow when implemented correctly. Start today!</p>
                          """
                      
                      word_count = len(content.split())
                      quality_score = random.randint(85, 97)
                      
                      result = {
                          "id": content_id,
                          "title": title,
                          "topic": topic,
                          "language": language,
                          "content": content,
                          "word_count": word_count,
                          "quality_score": quality_score,
                          "seo_score": random.randint(80, 95),
                          "created_at": datetime.now().isoformat(),
                          "monetized": True
                      }
                      
                      # Save to file
                      content_dir = f"{self.output_dir}/articles"
                      os.makedirs(content_dir, exist_ok=True)
                      
                      with open(f"{content_dir}/{content_id}.json", "w") as f:
                          json.dump(result, f, indent=2, ensure_ascii=False)
                      
                      # Create HTML version
                      html_content = f"""
                      <!DOCTYPE html>
                      <html lang="{language}">
                      <head>
                          <meta charset="UTF-8">
                          <meta name="viewport" content="width=device-width, initial-scale=1.0">
                          <title>{title}</title>
                          <style>
                              body {{ font-family: Arial, sans-serif; line-height: 1.6; max-width: 800px; margin: 0 auto; padding: 20px; }}
                              h1 {{ color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; }}
                              .affiliate {{ background: #f8f9fa; padding: 15px; border-left: 4px solid #2ecc71; margin: 20px 0; }}
                              .footer {{ margin-top: 40px; padding: 20px; background: #ecf0f1; text-align: center; }}
                          </style>
                      </head>
                      <body>
                          {content}
                          
                          <div class="affiliate">
                              <h3>üí∞ ·ã®·àö·àò·ä®·à© ·àù·à≠·â∂·âΩ</h3>
                              <ul>
                                  <li><a href="https://www.bluehost.com/track/profitmaster/" target="_blank">Bluehost Web Hosting</a> - ·â†·å£·àù ·å•·à© ·àÜ·àµ·â≤·äï·åç ·ä†·åà·àç·åç·àé·âµ</li>
                                  <li><a href="https://www.nordvpn.com/ref/profitmastervip/" target="_blank">NordVPN</a> - ·ã®·ä¢·äï·â∞·à≠·äî·âµ ·ã∞·àÖ·äï·äê·âµ</li>
                                  <li><a href="https://jasper.ai?fpr=profitmaster12" target="_blank">Jasper AI</a> - ·ã®AI ·ã®·ã≠·ãò·âµ ·çç·å†·à≠</li>
                              </ul>
                          </div>
                          
                          <div class="footer">
                              <p>‚úÖ ·ã≠·àÖ ·ã≠·ãò·âµ ·â†Profit Master Supreme v15.1 ·â†·à´·àµ-·à∞·à≠ ·â∞·çà·å•·àØ·àç</p>
                              <p>üìÖ ·âÄ·äï: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}</p>
                          </div>
                      </body>
                      </html>
                      """
                      
                      with open(f"{content_dir}/{content_id}.html", "w") as f:
                          f.write(html_content)
                      
                      # Save to database
                      conn = sqlite3.connect(self.db_path)
                      cursor = conn.cursor()
                      cursor.execute('''
                          INSERT INTO generated_content 
                          (content_id, title, topic, language, word_count, quality_score, seo_score, monetized, created_at, file_path)
                          VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                      ''', (
                          content_id, title, topic, language, word_count, quality_score, 
                          result["seo_score"], True, result["created_at"], f"{content_dir}/{content_id}.html"
                      ))
                      conn.commit()
                      conn.close()
                      
                      self.log_to_db("content_generation", "success", f"Content created: {content_id}")
                      self.logger.info(f"‚úÖ ·ã≠·ãò·âµ ·â∞·çà·å•·àØ·àç: {content_id} ({word_count} ·âÉ·àã·âµ, {quality_score}% ·å•·à´·âµ)")
                      
                      return result
                      
                  except Exception as e:
                      self.logger.error(f"Content generation failed: {e}")
                      self.log_to_db("content_generation", "failed", str(e))
                      return {}
              
              async def monetize_content(self, content: Dict) -> Dict:
                  """·ã≠·ãò·âµ·äï ·â†·ä†·çä·àä·ã¨·âµ ·àõ·àµ·â∞·ãã·ãà·âÖ"""
                  try:
                      affiliate_products = [
                          {"name": "Bluehost Pro", "commission": 75.0, "category": "hosting"},
                          {"name": "NordVPN Ultimate", "commission": 45.0, "category": "security"},
                          {"name": "Jasper AI Pro", "commission": 25.0, "category": "ai_tools"},
                          {"name": "ConvertKit Pro", "commission": 30.0, "category": "email_marketing"},
                          {"name": "Teachabled Pro", "commission": 30.0, "category": "education"}
                      ]
                      
                      selected_products = random.sample(affiliate_products, 3)
                      
                      monetization_data = {
                          "content_id": content["id"],
                          "products": selected_products,
                          "total_commission": sum(p["commission"] for p in selected_products),
                          "estimated_monthly": sum(p["commission"] for p in selected_products) * 10,
                          "created_at": datetime.now().isoformat()
                      }
                      
                      # Save affiliate data
                      affiliate_dir = f"{self.output_dir}/affiliate"
                      os.makedirs(affiliate_dir, exist_ok=True)
                      
                      with open(f"{affiliate_dir}/{content['id']}_affiliate.json", "w") as f:
                          json.dump(monetization_data, f, indent=2)
                      
                      # Track in database
                      conn = sqlite3.connect(self.db_path)
                      cursor = conn.cursor()
                      
                      for product in selected_products:
                          cursor.execute('''
                              INSERT INTO revenue_tracking 
                              (session_id, content_id, affiliate_product, commission_amount, estimated_earning, status)
                              VALUES (?, ?, ?, ?, ?, ?)
                          ''', (
                              self.session_id, content["id"], product["name"], 
                              product["commission"], product["commission"] * 2, "pending"
                          ))
                      
                      conn.commit()
                      conn.close()
                      
                      self.logger.info(f"üí∞ ·ã≠·ãò·âµ ·â∞·à∏·å¶·â†·â≥·àç: ${monetization_data['total_commission']} ·äÆ·àö·àΩ·äï")
                      return monetization_data
                      
                  except Exception as e:
                      self.logger.error(f"Monetization failed: {e}")
                      return {}
              
              async def send_telegram_notification(self, content: Dict, monetization: Dict):
                  """·ãà·ã∞ ·â¥·àå·åç·à´·àù ·àõ·à≥·ãà·âÇ·ã´ ·àò·àã·ä≠"""
                  try:
                      bot_token = os.getenv("TELEGRAM_BOT_TOKEN", "")
                      chat_id = os.getenv("TELEGRAM_CHAT_ID", "")
                      
                      if not bot_token or not chat_id:
                          self.logger.warning("Telegram credentials not set")
                          return
                      
                      message = f"""
                      üöÄ *PROFIT MASTER UPDATE*
                      
                      ‚úÖ *·ã®·ã≠·ãò·âµ ·à≠·ãï·àµ:* {content['title']}
                      üìä *·å•·à´·âµ ·ã∞·à®·åÉ:* {content['quality_score']}%
                      üìù *·ã®·âÉ·àã·âµ ·â•·ãõ·âµ:* {content['word_count']}
                      üí∞ *·ã®·â∞·åà·àò·â∞ ·äÆ·àö·àΩ·äï:* ${monetization.get('total_commission', 0)}
                      
                      üìÖ ·âÄ·äï: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
                      üÜî ·ä≠·çç·àç: {self.session_id}
                      
                      ·ã≠·àÖ ·ã≠·ãò·âµ ·â†·à´·àµ-·à∞·à≠ ·â∞·çà·å•·àØ·àç ·ä•·äì ·â∞·àΩ·åß·àç!
                      """
                      
                      url = f"https://api.telegram.org/bot{bot_token}/sendMessage"
                      payload = {
                          "chat_id": chat_id,
                          "text": message,
                          "parse_mode": "Markdown",
                          "disable_web_page_preview": True
                      }
                      
                      response = requests.post(url, json=payload, timeout=10)
                      
                      if response.status_code == 200:
                          self.logger.info("üì± ·â¥·àå·åç·à´·àù ·àõ·à≥·ãà·âÇ·ã´ ·â∞·àç·ä≥·àç")
                          
                          # Save to database
                          conn = sqlite3.connect(self.db_path)
                          cursor = conn.cursor()
                          cursor.execute('''
                              INSERT INTO social_media_posts 
                              (platform, content_id, post_text, status, link)
                              VALUES (?, ?, ?, ?, ?)
                          ''', ("telegram", content["id"], message[:200], "sent", ""))
                          conn.commit()
                          conn.close()
                          
                          # Update content as telegram sent
                          cursor.execute('''
                              UPDATE generated_content SET telegram_sent = 1 WHERE content_id = ?
                          ''', (content["id"],))
                          conn.commit()
                          conn.close()
                          
                      else:
                          self.logger.error(f"Telegram failed: {response.text}")
                          
                  except Exception as e:
                      self.logger.error(f"Telegram notification failed: {e}")
              
              async def generate_dashboard(self):
                  """·ã®·ã≤·àΩ·â¶·à≠·ãµ ·ã≠·çç·å†·à≠"""
                  try:
                      # Collect statistics
                      conn = sqlite3.connect(self.db_path)
                      
                      # Total content
                      cursor = conn.cursor()
                      cursor.execute("SELECT COUNT(*) FROM generated_content")
                      total_content = cursor.fetchone()[0]
                      
                      cursor.execute("SELECT COUNT(*) FROM generated_content WHERE telegram_sent = 1")
                      telegram_sent = cursor.fetchone()[0]
                      
                      cursor.execute("SELECT SUM(commission_amount) FROM revenue_tracking WHERE session_id = ?", (self.session_id,))
                      total_commission = cursor.fetchone()[0] or 0
                      
                      cursor.execute("SELECT AVG(quality_score) FROM generated_content")
                      avg_quality = cursor.fetchone()[0] or 0
                      
                      conn.close()
                      
                      # Create dashboard HTML
                      dashboard_html = f"""
                      <!DOCTYPE html>
                      <html lang="en">
                      <head>
                          <meta charset="UTF-8">
                          <meta name="viewport" content="width=device-width, initial-scale=1.0">
                          <title>Profit Master Dashboard</title>
                          <style>
                              * {{ margin: 0; padding: 0; box-sizing: border-box; }}
                              body {{ font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #333; line-height: 1.6; }}
                              .container {{ max-width: 1200px; margin: 0 auto; padding: 20px; }}
                              header {{ background: rgba(255, 255, 255, 0.95); border-radius: 20px; padding: 40px; margin-bottom: 30px; text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,0.1); }}
                              h1 {{ color: #4a5568; font-size: 3em; margin-bottom: 10px; }}
                              .stats-grid {{ display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px; margin-bottom: 40px; }}
                              .stat-card {{ background: rgba(255, 255, 255, 0.95); border-radius: 15px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); }}
                              .stat-value {{ font-size: 2.5em; font-weight: bold; color: #4a5568; margin: 10px 0; }}
                              .stat-label {{ color: #718096; font-size: 0.9em; text-transform: uppercase; letter-spacing: 1px; }}
                              table {{ width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.08); }}
                              th, td {{ padding: 15px; text-align: left; border-bottom: 1px solid #e2e8f0; }}
                              th {{ background: #f7fafc; color: #4a5568; font-weight: 600; }}
                              .footer {{ text-align: center; padding: 30px; color: #a0aec0; margin-top: 50px; }}
                          </style>
                      </head>
                      <body>
                          <div class="container">
                              <header>
                                  <h1>üöÄ Profit Master Supreme</h1>
                                  <p>Advanced AI Content & Monetization System</p>
                                  <p>Session: {self.session_id} | Last Update: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}</p>
                              </header>
                              
                              <div class="stats-grid">
                                  <div class="stat-card">
                                      <div class="stat-label">Total Content Generated</div>
                                      <div class="stat-value">{total_content}</div>
                                      <div class="stat-desc">AI-powered articles</div>
                                  </div>
                                  <div class="stat-card">
                                      <div class="stat-label">Average Quality Score</div>
                                      <div class="stat-value">{avg_quality:.1f}%</div>
                                      <div class="stat-desc">Human-like content</div>
                                  </div>
                                  <div class="stat-card">
                                      <div class="stat-label">Telegram Notifications</div>
                                      <div class="stat-value">{telegram_sent}</div>
                                      <div class="stat-desc">Successfully sent</div>
                                  </div>
                                  <div class="stat-card">
                                      <div class="stat-label">Total Commission</div>
                                      <div class="stat-value">${total_commission:.2f}</div>
                                      <div class="stat-desc">Estimated earnings</div>
                                  </div>
                              </div>
                              
                              <h2 style="color: white; margin: 30px 0 20px 0;">Recent Content</h2>
                              <table>
                                  <thead>
                                      <tr>
                                          <th>Title</th>
                                          <th>Language</th>
                                          <th>Words</th>
                                          <th>Quality</th>
                                          <th>Monetized</th>
                                      </tr>
                                  </thead>
                                  <tbody>
                      """
                      
                      # Get recent content
                      conn = sqlite3.connect(self.db_path)
                      cursor = conn.cursor()
                      cursor.execute("""
                          SELECT title, language, word_count, quality_score, monetized 
                          FROM generated_content 
                          ORDER BY created_at DESC 
                          LIMIT 10
                      """)
                      
                      for row in cursor.fetchall():
                          dashboard_html += f"""
                                      <tr>
                                          <td>{row[0][:50]}...</td>
                                          <td>{row[1].upper()}</td>
                                          <td>{row[2]}</td>
                                          <td>{row[3]}%</td>
                                          <td>{"‚úÖ" if row[4] else "‚ùå"}</td>
                                      </tr>
                          """
                      
                      conn.close()
                      
                      dashboard_html += f"""
                                  </tbody>
                              </table>
                              
                              <div class="footer">
                                  <p>Generated automatically by Profit Master Supreme v15.1</p>
                                  <p>¬© {datetime.now().year} - All rights reserved</p>
                              </div>
                          </div>
                      </body>
                      </html>
                      """
                      
                      # Save dashboard
                      dashboard_dir = f"{self.output_dir}/dashboard"
                      os.makedirs(dashboard_dir, exist_ok=True)
                      
                      with open(f"{dashboard_dir}/index.html", "w") as f:
                          f.write(dashboard_html)
                      
                      self.logger.info("üìä ·ã≤·àΩ·â¶·à≠·ãµ ·â∞·çà·å•·àØ·àç")
                      
                  except Exception as e:
                      self.logger.error(f"Dashboard generation failed: {e}")
              
              async def run_full_cycle(self, topic: str = "AI Technology", language: str = "am"):
                  """·àô·àâ ·ãë·ã∞·âµ ·àõ·àµ·ä¨·ãµ"""
                  start_time = time.time()
                  
                  self.logger.info(f"üöÄ ·àô·àâ ·ãë·ã∞·âµ ·ä•·ã®·åÄ·àò·à® ·äê·ãç...")
                  self.log_to_db("full_cycle", "started", f"Topic: {topic}, Language: {language}")
                  
                  try:
                      # 1. ·ã≠·ãò·âµ ·çç·å†·à≠
                      content = await self.generate_ai_content(topic, language)
                      
                      if not content:
                          raise Exception("Content generation failed")
                      
                      # 2. ·ä†·çä·àä·ã¨·âµ ·àõ·àµ·â∞·ãã·ãà·âÖ
                      monetization = await self.monetize_content(content)
                      
                      # 3. ·â¥·àå·åç·à´·àù ·àõ·à≥·ãà·âÇ·ã´
                      await self.send_telegram_notification(content, monetization)
                      
                      # 4. ·ã≤·àΩ·â¶·à≠·ãµ ·çç·å†·à≠
                      await self.generate_dashboard()
                      
                      # 5. ·ã®·ä†·çà·çÉ·çÄ·àù ·à™·çñ·à≠·âµ
                      duration = time.time() - start_time
                      
                      report = {
                          "session_id": self.session_id,
                          "status": "success",
                          "content_id": content["id"],
                          "topic": topic,
                          "language": language,
                          "word_count": content["word_count"],
                          "quality_score": content["quality_score"],
                          "total_commission": monetization.get("total_commission", 0),
                          "duration_seconds": round(duration, 2),
                          "created_at": datetime.now().isoformat()
                      }
                      
                      # Save report
                      reports_dir = f"{self.output_dir}/reports"
                      os.makedirs(reports_dir, exist_ok=True)
                      
                      with open(f"{reports_dir}/{self.session_id}_report.json", "w") as f:
                          json.dump(report, f, indent=2)
                      
                      self.log_to_db("full_cycle", "completed", f"Success: {content['id']}")
                      self.logger.info(f"‚úÖ ·àô·àâ ·ãë·ã∞·âµ ·â∞·å†·äì·âã·àç! ·â†{duration:.2f} ·à∞·ä®·äï·ãµ")
                      
                      return report
                      
                  except Exception as e:
                      self.logger.error(f"Full cycle failed: {e}")
                      self.log_to_db("full_cycle", "failed", str(e))
                      return {"status": "error", "error": str(e)}
          
          async def main():
              session_id = os.getenv("SESSION_ID", "test_session")
              operation_mode = os.getenv("OPERATION_MODE", "full-auto")
              
              # Command line arguments
              import sys
              topic = "AI Technology"
              language = "am"
              
              if len(sys.argv) > 1:
                  if "--auto" in sys.argv:
                      operation_mode = "full-auto"
                  if "--topic" in sys.argv:
                      try:
                          topic_idx = sys.argv.index("--topic") + 1
                          if topic_idx < len(sys.argv):
                              topic = sys.argv[topic_idx]
                      except:
                          pass
                  if "--language" in sys.argv:
                      try:
                          lang_idx = sys.argv.index("--language") + 1
                          if lang_idx < len(sys.argv):
                              language = sys.argv[lang_idx]
                      except:
                          pass
              
              profit_master = UltimateProfitMaster(session_id)
              
              if operation_mode == "full-auto":
                  await profit_master.run_full_cycle(topic, language)
              elif operation_mode == "content-only":
                  content = await profit_master.generate_ai_content(topic, language)
                  print(f"Content generated: {content['id']}")
              elif operation_mode == "affiliate-only":
                  # For testing
                  test_content = {"id": "test_123", "title": "Test", "word_count": 1000, "quality_score": 90}
                  await profit_master.monetize_content(test_content)
              else:
                  await profit_master.run_full_cycle(topic, language)
          
          if __name__ == "__main__":
              asyncio.run(main())
          EOF
          
            echo "‚úÖ ·ã®·àô·ä®·à´ ·çã·ã≠·àç ·â∞·çà·å•·àØ·àç"
          fi

  execute_main_script:
    needs: [system_initialization, setup_environment]
    runs-on: ubuntu-latest
    name: "ü§ñ ·ãã·äì ·àµ·ä≠·à™·çï·âµ ·àõ·àµ·ä¨·ãµ"
    timeout-minutes: 30
    
    steps:
      - name: "üîß ·ä†·ä´·â£·â¢ ·â∞·àà·ãã·ãã·åÆ·âΩ ·àõ·ãò·åã·åÄ·âµ"
        env:
          SESSION_ID: ${{ needs.system_initialization.outputs.session_id }}
          OPERATION_MODE: ${{ github.event.inputs.mode || 'full-auto' }}
          TOPIC: ${{ github.event.inputs.topic || 'AI ·ä•·äì ·ä†·çä·àä·ã¨·âµ ·àõ·à≠·ä¨·â≤·äï·åç' }}
          LANGUAGE: ${{ github.event.inputs.language || 'am' }}
        run: |
          echo "SESSION_ID=$SESSION_ID" >> $GITHUB_ENV
          echo "OPERATION_MODE=$OPERATION_MODE" >> $GITHUB_ENV
          echo "TOPIC=$TOPIC" >> $GITHUB_ENV
          echo "LANGUAGE=$LANGUAGE" >> $GITHUB_ENV
          
      - name: "üöÄ ·ãã·äì ·àµ·ä≠·à™·çï·âµ ·àõ·àµ·ä¨·ãµ"
        env:
          SESSION_ID: ${{ env.SESSION_ID }}
          OPERATION_MODE: ${{ env.OPERATION_MODE }}
          
          # AI API Keys
          GROQ_API_KEY: ${{ secrets.GROQ_API_KEY }}
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
          COHERE_API_KEY: ${{ secrets.COHERE_API_KEY }}
          HUGGINGFACE_TOKEN: ${{ secrets.HUGGINGFACE_TOKEN }}
          
          # Telegram Configuration
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
          
          # Database Configuration
          DATABASE_URL: "sqlite:////opt/profit_master/data/profit_master.db"
          REDIS_URL: "redis://localhost:6379/0"
          
          # System Configuration
          PYTHONPATH: "/opt/profit_master"
          LOG_LEVEL: "INFO"
          ENABLE_TELEGRAM: "true"
          ENABLE_LOGGING: "true"
          
        run: |
          cd /opt/profit_master
          
          echo "=== SYSTEM INFORMATION ==="
          echo "Session ID: $SESSION_ID"
          echo "Operation Mode: $OPERATION_MODE"
          echo "Topic: $TOPIC"
          echo "Language: $LANGUAGE"
          echo "Python Version: $(python3 --version)"
          echo "Working Directory: $(pwd)"
          echo "=========================="
          
          # Run the main script
          echo "üöÄ ·ãã·äì ·àµ·ä≠·à™·çï·âµ ·ä•·ã®·â∞·à∞·à´ ·äê·ãç..."
          
          # Check if we have GROQ API key (most important)
          if [ -z "$GROQ_API_KEY" ]; then
            echo "‚ö†Ô∏è WARNING: GROQ_API_KEY is not set. Using simulated mode."
            echo "Please add GROQ_API_KEY to GitHub Secrets for full AI capabilities."
          else
            echo "‚úÖ GROQ API key is available"
          fi
          
          # Execute with proper arguments
          python3 -u main.py --auto --topic "$TOPIC" --language "$LANGUAGE"
          
          # Check exit code
          if [ $? -eq 0 ]; then
            echo "‚úÖ ·àµ·ä≠·à™·çï·âµ ·â†·â∞·à≥·ä´ ·àÅ·äî·â≥ ·â∞·å†·äì·âã·àç"
          else
            echo "‚ùå ·àµ·ä≠·à™·çï·âµ ·âΩ·åç·à≠ ·ä†·åã·å•·àû·â≥·àç"
            # Continue anyway to save results
          fi
          
      - name: "üìä ·ãç·å§·â∂·âΩ·äï ·àò·à∞·â•·à∞·â•"
        run: |
          cd /opt/profit_master
          
          # Create summary report
          cat > summary_report.md << EOF
          # üöÄ Profit Master Supreme - ·ã®·àµ·à´ ·à™·çñ·à≠·âµ
          
          ## ·ãù·à≠·ãù·à≠ ·àò·à®·åÉ
          - **·àµ·à≠·ãì·âµ ·àò·àà·ã´:** ${{ env.SESSION_ID }}
          - **·àõ·àµ·ä¨·ãµ ·âÄ·äï:** $(date)
          - **·àû·ãµ:** ${{ env.OPERATION_MODE }}
          - **·à≠·ãï·àµ:** ${{ env.TOPIC }}
          - **·âã·äï·âã:** ${{ env.LANGUAGE }}
          
          ## ·ã®·â∞·çà·å†·à® ·ã≠·ãò·âµ
          EOF
          
          # Count generated files
          if [ -d "public/articles" ]; then
            ARTICLE_COUNT=$(find public/articles -name "*.html" | wc -l)
            echo "- **·ã®·â∞·çà·å†·à© ·ã®·ã≠·ãò·âµ ·åà·åæ·âΩ:** $ARTICLE_COUNT" >> summary_report.md
          fi
          
          if [ -d "public/affiliate" ]; then
            AFFILIATE_COUNT=$(find public/affiliate -name "*.json" | wc -l)
            echo "- **·ã®·ä†·çä·àä·ã¨·âµ ·çã·ã≠·àé·âΩ:** $AFFILIATE_COUNT" >> summary_report.md
          fi
          
          # Database statistics
          if [ -f "data/profit_master.db" ]; then
            DB_STATS=$(sqlite3 data/profit_master.db "SELECT COUNT(*) FROM generated_content;" 2>/dev/null || echo "0")
            echo "- **·â†·ãç·àÇ·â• ·åé·â≥ ·ãç·àµ·å• ·ã´·àâ ·ã≠·ãò·â∂·âΩ:** $DB_STATS" >> summary_report.md
          fi
          
          echo "" >> summary_report.md
          echo "## üìÅ ·ã®·â∞·çà·å†·à© ·çã·ã≠·àé·âΩ" >> summary_report.md
          find public -type f -name "*.html" -o -name "*.json" | head -10 | while read file; do
            echo "- \`${file#public/}\`" >> summary_report.md
          done
          
          echo "" >> summary_report.md
          echo "---" >> summary_report.md
          echo "*Generated automatically by Profit Master Supreme v15.1*" >> summary_report.md
          
          # Copy summary to workspace
          cp summary_report.md $GITHUB_WORKSPACE/

  deploy_to_github_pages:
    needs: execute_main_script
    runs-on: ubuntu-latest
    name: "üåê ·ãà·ã∞ GitHub Pages ·àõ·à∞·à´·å®·âµ"
    
    steps:
      - name: "üì• ·ã®·â∞·çà·å†·à©·âµ·äï ·çã·ã≠·àé·âΩ ·àõ·ãç·à®·ãµ"
        uses: actions/download-artifact@v4
        with:
          name: profit-master-output
          path: ./public
          
      - name: "üöÄ GitHub Pages ·àã·ã≠ ·àõ·à∞·à´·å®·âµ"
        uses: peaceiris/actions-gh-pages@v4
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./public
          keep_files: true
          force_orphan: false
          user_name: 'github-actions[bot]'
          user_email: 'github-actions[bot]@users.noreply.github.com'
          
      - name: "üîó ·ã®·ã≤·çï·àé·ã≠ ·àõ·àµ·â≥·ãà·àª"
        run: |
          echo "‚úÖ GitHub Pages deployed successfully!"
          echo ""
          echo "üìä Your dashboard is now live at:"
          echo "https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/"
          echo ""
          echo "üìÅ Generated content available at:"
          echo "https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/articles/"
          echo ""
          echo "üîß Session ID: ${{ env.SESSION_ID }}"

  telegram_notification:
    needs: [execute_main_script, deploy_to_github_pages]
    runs-on: ubuntu-latest
    name: "üì± ·â¥·àå·åç·à´·àù ·àõ·à≥·ãà·âÇ·ã´"
    if: always()
    
    steps:
      - name: "üì® ·àà·â¥·àå·åç·à´·àù ·àò·àç·ãï·ä≠·âµ ·àò·àã·ä≠"
        env:
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
          SESSION_ID: ${{ env.SESSION_ID }}
          JOB_STATUS: ${{ job.status }}
        run: |
          if [ -z "$TELEGRAM_BOT_TOKEN" ] || [ -z "$TELEGRAM_CHAT_ID" ]; then
            echo "‚ö†Ô∏è Telegram credentials not set. Skipping notification."
            exit 0
          fi
          
          if [ "$JOB_STATUS" = "success" ]; then
            EMOJI="‚úÖ"
            STATUS_TEXT="·â†·â∞·à≥·ä´ ·àÅ·äî·â≥ ·â∞·å†·äì·âã·àç"
          else
            EMOJI="‚ö†Ô∏è"
            STATUS_TEXT="·âΩ·åç·à≠ ·ä†·åã·å•·àû·â≥·àç"
          fi
          
          MESSAGE="$EMOJI *PROFIT MASTER SUPREME UPDATE*
          
          ·àµ·à≠·ãì·âµ ·àõ·àµ·ä¨·ãµ: $STATUS_TEXT
          
          üìä *·ãù·à≠·ãù·à≠ ·àò·à®·åÉ*
          ‚Ä¢ ·àµ·à≠·ãì·âµ ·àò·àà·ã´: \`$SESSION_ID\`
          ‚Ä¢ ·àõ·àµ·ä¨·ãµ ·àÅ·äî·â≥: $JOB_STATUS
          ‚Ä¢ ·ã®·àõ·àµ·ä¨·ãµ ·âÄ·äï: $(date '+%Y-%m-%d %H:%M:%S')
          ‚Ä¢ ·à¨·çñ·ãö·â∂·à™: ${{ github.repository }}
          
          üåê *·ã≤·çï·àé·ã≠ ·àõ·àµ·â≥·ãà·àª*
          ·ã≤·àΩ·â¶·à≠·ãµ: https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/
          
          üìÅ *·ã®·â∞·çà·å†·à© ·çã·ã≠·àé·âΩ*
          ·ã≠·ãò·â∂·âΩ·ç£ ·ã®·ä†·çä·àä·ã¨·âµ ·àò·à®·åÉ·ãé·âΩ ·ä•·äì ·ã≤·àΩ·â¶·à≠·ãµ ·â†·à´·àµ-·à∞·à≠ ·â∞·çà·å•·à®·ãã·àç·ç¢
          
          üîÑ *·âÄ·å£·ã≠ ·àõ·àµ·ä¨·ãµ*
          ·âÄ·å£·ã© ·àõ·àµ·ä¨·ãµ ·â† 6 ·à∞·ãì·âµ ·ãç·àµ·å• ·ã≠·åÄ·àò·à´·àç·ç¢
          
          _Generated by Profit Master Supreme v15.1_"
          
          # Send via curl
          curl -s -X POST "https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/sendMessage" \
            -d chat_id="$TELEGRAM_CHAT_ID" \
            -d text="$MESSAGE" \
            -d parse_mode="Markdown" \
            -d disable_web_page_preview=true
            
          echo "‚úÖ Telegram notification sent!"

  save_results:
    needs: [execute_main_script, telegram_notification]
    runs-on: ubuntu-latest
    name: "üíæ ·ãç·å§·â∂·âΩ·äï ·àò·âÄ·àò·å•"
    if: always()
    
    steps:
      - name: "üì¶ ·ãç·å§·â∂·âΩ·äï ·ä•·äï·ã∞ ·ä†·à≠·â≤·çã·ä≠·âµ ·àò·âÄ·àò·å•"
        uses: actions/upload-artifact@v4
        with:
          name: profit-master-output-${{ env.SESSION_ID }}
          path: |
            /opt/profit_master/public/
            /opt/profit_master/data/profit_master.db
            /opt/profit_master/logs/
            /opt/profit_master/summary_report.md
          retention-days: 90
          
      - name: "üìã ·ã®·àµ·à´ ·àõ·å†·âÉ·àà·ã´ ·àõ·â∞·àù"
        run: |
          echo "=========================================="
          echo "üöÄ PROFIT MASTER SUPREME - ·àµ·à´ ·â∞·å†·äì·âã·àç"
          echo "=========================================="
          echo ""
          echo "üìä ·ã®·àµ·à´ ·àõ·å†·âÉ·àà·ã´:"
          echo "‚Ä¢ ·àµ·à≠·ãì·âµ ·àò·àà·ã´: ${{ env.SESSION_ID }}"
          echo "‚Ä¢ ·àµ·â≥·â∞·àµ: ${{ job.status }}"
          echo "‚Ä¢ ·àõ·àµ·ä¨·ãµ ·âÄ·äï: $(date)"
          echo "‚Ä¢ ·à¨·çñ·ãö·â∂·à™: ${{ github.repository }}"
          echo ""
          echo "üåê ·ã®·ã≤·çï·àé·ã≠ ·àõ·àµ·â≥·ãà·àª:"
          echo "Dashboard: https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/"
          echo ""
          echo "üì± ·â¥·àå·åç·à´·àù ·àõ·à≥·ãà·âÇ·ã´:"
          if [ -n "${{ secrets.TELEGRAM_BOT_TOKEN }}" ] && [ -n "${{ secrets.TELEGRAM_CHAT_ID }}" ]; then
            echo "‚úÖ ·â∞·àç·ä≥·àç"
          else
            echo "‚ö†Ô∏è ·ä†·àç·â∞·àã·ä®·àù (·àù·àµ·å¢·àÆ·âΩ ·ä†·àç·â∞·åà·äô·àù)"
          fi
          echo ""
          echo "üîß ·âÄ·å£·ã≠ ·àõ·àµ·ä¨·ãµ: ·â† 6 ·à∞·ãì·âµ ·ãç·àµ·å•"
          echo "=========================================="
