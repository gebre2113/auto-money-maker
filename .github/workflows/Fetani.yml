name: ğŸ§ª Profit Master Engine - INDIVIDUAL TEST RUN

on:
  workflow_dispatch: # á‰ áŠ¥áŒ…áˆ… Run áˆµá‰µáˆˆá‹ á‰¥á‰» áŠ¥áŠ•á‹²áˆ°áˆ«
  push:
    paths:
      - 'profit_master_system.py' # á‹­áˆ„ á‹á‹­áˆ á‰ á‰°á‰€á‹¨áˆ¨ á‰áŒ¥áˆ­ áˆ«áˆ± á‹­áˆá‰µáˆ»áˆ

jobs:
  individual-test:
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4

      - name: ğŸ Setup Python 3.10
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: ğŸ“¦ Install Essential Dependencies
        run: |
          python -m pip install --upgrade pip
          pip install groq google-generativeai python-dotenv pydantic==1.10.11 jinja2 requests textblob

      - name: ğŸ” Step 1: Syntax Validation
        id: syntax
        run: |
          echo "ğŸ§ á‹á‹­áˆ‰áŠ• áˆˆáˆ°á‹‹áˆµá‹ áˆµáˆ…á‰°á‰µ áŠ¥á‹¨áˆ˜áˆ¨áˆ˜áˆ­áŠ© áŠá‹..."
          python -m py_compile profit_master_system.py
          echo "âœ… áˆáŠ•áˆ áŠ á‹­áŠá‰µ á‹¨áˆ°á‹‹áˆµá‹ (Syntax) áˆµáˆ…á‰°á‰µ áŠ áˆá‰°áŒˆáŠ˜áˆ!"

      - name: ğŸ—ï¸ Step 2: Object Initialization Test
        id: init
        run: |
          echo "ğŸ—ï¸ á‹¨ ProfitMaster áŠ­áˆ‹áˆµáŠ• áˆˆáˆ˜áŒ«áŠ• áŠ¥á‹¨áˆáŠ¨áˆ­áŠ© áŠá‹..."
          python -c "from profit_master_system import ProfitMaster; pm = ProfitMaster(); print('âœ… áŠ­áˆ‹áˆ± á‰ á‰µáŠ­áŠ­áˆ á‰°áŒ­áŠ—áˆ!')"

      - name: ğŸš€ Step 3: Content Generation Logic Test
        env:
          GROQ_API_KEY: ${{ secrets.GROQ_API_KEY }}
          GOOGLE_API_KEY: ${{ secrets.GOOGLE_API_KEY }}
        run: |
          echo "ğŸš€ á‹¨ AI áˆ›áˆ˜áŠ•áŒ«á‹áŠ• áˆˆá‰¥á‰»á‹ áŠ¥á‹¨áˆá‰°áˆ½áŠ© áŠá‹..."
          python -c "
          import asyncio
          import sys
          try:
              from profit_master_system import ProfitMaster
              async def run_test():
                  engine = ProfitMaster()
                  # á‹¨áˆ™áŠ¨áˆ« áˆ­á‹•áˆµ
                  test_topic = 'Future of AI in Ethiopia 2026'
                  print(f'ğŸ“ áˆ™áŠ¨áˆ« áŠ¥á‹¨á‰°á‹°áˆ¨áŒˆá‰ á‰µ á‹«áˆˆá‹ áˆ­á‹•áˆµ: {test_topic}')
                  result = await engine.generate_content(test_topic)
                  if result and ('content' in result or 'sections' in result):
                      print('âœ… áˆµáŠ¬á‰µ: á‹¨ AI á‹­á‹˜á‰µ áˆ›áˆ˜áŠ•áŒ«á‹ á‰ á‰µáŠ­áŠ­áˆ áˆ°áˆ­á‰·áˆ!')
                  else:
                      print('âŒ áˆµáˆ…á‰°á‰µ: á‹­á‹˜á‰µ áŠ áˆá‰°áˆ˜áˆ¨á‰°áˆ!')
                      sys.exit(1)
              asyncio.run(run_test())
          except Exception as e:
              print(f'âŒ áŠ áˆá‰°áˆ³áŠ«áˆ: {str(e)}')
              sys.exit(1)
          "
