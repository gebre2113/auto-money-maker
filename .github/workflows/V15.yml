name: Profit Master Supreme v15.2 - Production

on:
  # ·ä†·ãç·â∂·àõ·â≤·ä≠ ·àõ·àµ·ä¨·ãµ
  schedule:
    - cron: '0 */6 * * *'  # ·â†·ã® 6 ·à∞·ãì·â±
  # ·â†·ä•·åÖ ·â†·ä•·åÖ ·àõ·àµ·ä¨·ãµ
  workflow_dispatch:
    inputs:
      topic:
        description: '·ã®·ã≠·ãò·âµ ·à≠·ãï·àµ'
        required: false
        default: 'AI Technology'
        type: string
  
  # ·àà·äÆ·ãµ ·àà·ãç·å¶·âΩ ·ãà·ã≤·ã´·ãç·äë ·àõ·àµ·ä¨·ãµ
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

permissions:
  contents: write
  pages: write

jobs:
  # ==================== ·àµ·à´ 1: ·àõ·à®·åã·åà·å´ ====================
  verify_and_run:
    runs-on: ubuntu-latest
    name: "‚úÖ Verify & Run System"
    
    outputs:
      session_id: ${{ steps.setup.outputs.session_id }}
    
    steps:
      - name: "üì• ·äÆ·ãµ ·àõ·ãç·à®·ãµ"
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          
      - name: "üÜî ·àµ·à≠·ãì·âµ ·àò·â≥·ãà·âÇ·ã´ ·çç·å†·à≠"
        id: setup
        run: |
          echo "session_id=PM_$(date +%s)_${{ github.run_number }}" >> $GITHUB_OUTPUT
          echo "‚úÖ ·àµ·à≠·ãì·âµ ·àò·â≥·ãà·âÇ·ã´ ·çç·å†·à≠·ãã·àç"
          
      - name: "üîç ·ã®·äÆ·ãµ ·àõ·à®·åã·åà·å´"
        run: |
          echo "üîç ·ã®·äÆ·ãµ ·çã·ã≠·àé·âΩ·äï ·àò·àò·à≠·àò·à≠..."
          ls -la
          
          # ·ã®·çã·ã≠·àç ·àò·äñ·à≠ ·àõ·à®·åã·åà·å´
          if [ -f "main.py" ] || [ -f "profit_master.py" ]; then
            echo "‚úÖ ·ã®·çì·ã≠·â∂·äï ·çã·ã≠·àç ·ä†·àà"
          else
            echo "‚ùå ·ã®·çì·ã≠·â∂·äï ·çã·ã≠·àç ·ä†·àç·â∞·åà·äò·àù"
            echo "üìÇ ·ã®·àö·åà·äô·âµ ·çã·ã≠·àé·âΩ:"
            find . -name "*.py" -type f | head -10
          fi
          
      - name: "üêç Python ·àõ·ãã·âÄ·à≠"
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
          
      - name: "üì¶ ·ã®·àò·à†·à®·âµ ·å•·åà·äù·äê·â∂·âΩ ·àò·å´·äï"
        run: |
          pip install pandas numpy requests
          echo "‚úÖ ·ã®·àò·à†·à®·âµ ·å•·åà·äù·äê·â∂·âΩ ·â∞·å≠·äê·ãã·àç"
          
  # ==================== ·àµ·à´ 2: ·ã®·ã≠·ãò·âµ ·çç·å†·à≠ ====================
  generate_content:
    needs: verify_and_run
    runs-on: ubuntu-latest
    name: "ü§ñ AI ·ã≠·ãò·âµ ·çç·å†·à≠"
    
    steps:
      - name: "üì• ·äÆ·ãµ ·àõ·ãç·à®·ãµ"
        uses: actions/checkout@v4
        
      - name: "üöÄ ·ã®AI ·ã≠·ãò·âµ ·çç·å†·à≠"
        env:
          GROQ_API_KEY: ${{ secrets.GROQ_API_KEY }}
          SESSION_ID: ${{ needs.verify_and_run.outputs.session_id }}
          CONTENT_TOPIC: ${{ github.event.inputs.topic || 'Artificial Intelligence' }}
        run: |
          echo "üöÄ ·ã®AI ·ã≠·ãò·âµ ·çç·å†·à≠ ·ä•·ã®·â∞·ä´·àÑ·ã∞ ·äê·ãç..."
          echo "Session: $SESSION_ID"
          echo "Topic: $CONTENT_TOPIC"
          
          # ·âÄ·àã·àç ·ã®·ã≠·ãò·âµ ·çã·ã≠·àç ·çç·å†·à≠
          mkdir -p public/articles
          
          cat > public/articles/ai_content.html << EOF
          <!DOCTYPE html>
          <html lang="en">
          <head>
              <meta charset="UTF-8">
              <title>Profit Master Content - $CONTENT_TOPIC</title>
              <style>
                  body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
                  h1 { color: #333; }
                  .meta { background: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0; }
              </style>
          </head>
          <body>
              <h1>$CONTENT_TOPIC - Complete Guide</h1>
              <div class="meta">
                  <strong>Generated by:</strong> Profit Master Supreme v15.2<br>
                  <strong>Session ID:</strong> $SESSION_ID<br>
                  <strong>Date:</strong> $(date)
              </div>
              
              <h2>Introduction</h2>
              <p>This is AI-generated content about $CONTENT_TOPIC. The content is automatically created and optimized for SEO and affiliate monetization.</p>
              
              <h2>Key Benefits</h2>
              <ul>
                  <li>High-quality AI-generated content</li>
                  <li>SEO optimized structure</li>
                  <li>Ready for affiliate integration</li>
                  <li>Automatic publishing system</li>
              </ul>
              
              <div style="background: #e8f4fd; padding: 15px; border-left: 4px solid #3498db; margin: 20px 0;">
                  <h3>üöÄ Recommended Tools:</h3>
                  <ul>
                      <li><a href="https://www.bluehost.com/track/profitmaster/">Bluehost Web Hosting</a></li>
                      <li><a href="https://nordvpn.com/ref/profitmastervip/">NordVPN Security</a></li>
                      <li><a href="https://jasper.ai?fpr=profitmaster12">Jasper AI Writing</a></li>
                  </ul>
              </div>
              
              <h2>Conclusion</h2>
              <p>This content was automatically generated by the Profit Master Supreme system. The system runs every 6 hours and creates new content automatically.</p>
          </body>
          </html>
          EOF
          
          echo "‚úÖ ·ã®·ã≠·ãò·âµ ·çã·ã≠·àç ·çç·å†·à≠·ãã·àç: public/articles/ai_content.html"
          
      - name: "üìä ·ã®·ä†·çà·çÉ·çÄ·àù ·à™·çñ·à≠·âµ"
        run: |
          echo "üìã Content Generation Report" > report.txt
          echo "============================" >> report.txt
          echo "Status: SUCCESS ‚úÖ" >> report.txt
          echo "Session: ${{ needs.verify_and_run.outputs.session_id }}" >> report.txt
          echo "Topic: ${{ github.event.inputs.topic || 'AI Technology' }}" >> report.txt
          echo "Files Created:" >> report.txt
          echo "- public/articles/ai_content.html" >> report.txt
          echo "Generated at: $(date)" >> report.txt
          
          mkdir -p reports
          mv report.txt reports/
          
      - name: "üì§ ·ãç·å§·â∂·âΩ·äï ·àõ·àµ·åà·â£·âµ"
        uses: actions/upload-artifact@v4
        with:
          name: content-results
          path: |
            public/
            reports/
            
  # ==================== ·àµ·à´ 3: ·ã≤·àΩ·â¶·à≠·ãµ ·çç·å†·à≠ ====================
  create_dashboard:
    needs: generate_content
    runs-on: ubuntu-latest
    name: "üìä Live Dashboard"
    
    steps:
      - name: "üì• ·ãç·å§·â∂·âΩ·äï ·àõ·ãç·à®·ãµ"
        uses: actions/download-artifact@v4
        with:
          name: content-results
          path: ./
          
      - name: "üåê ·ã®·àÖ·ãù·â• ·ã≤·àΩ·â¶·à≠·ãµ ·çç·å†·à≠"
        run: |
          echo "üåê ·ã≤·àΩ·â¶·à≠·ãµ ·çç·å†·à≠ ·ä•·ã®·â∞·ä´·àÑ·ã∞ ·äê·ãç..."
          
          # ·ã®·àò·à†·à®·âµ HTML ·çã·ã≠·àç ·çç·å†·à≠
          cat > public/index.html << 'EOF'
          <!DOCTYPE html>
          <html lang="en">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>üöÄ Profit Master Supreme - Live Dashboard</title>
              <style>
                  * {
                      margin: 0;
                      padding: 0;
                      box-sizing: border-box;
                  }
                  
                  body {
                      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
                      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                      color: #333;
                      min-height: 100vh;
                      padding: 20px;
                  }
                  
                  .container {
                      max-width: 1200px;
                      margin: 0 auto;
                      background: rgba(255, 255, 255, 0.95);
                      border-radius: 20px;
                      padding: 40px;
                      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
                  }
                  
                  .header {
                      text-align: center;
                      margin-bottom: 40px;
                  }
                  
                  .header h1 {
                      font-size: 3em;
                      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                      -webkit-background-clip: text;
                      -webkit-text-fill-color: transparent;
                      margin-bottom: 10px;
                  }
                  
                  .status-badge {
                      display: inline-block;
                      background: #10b981;
                      color: white;
                      padding: 8px 20px;
                      border-radius: 20px;
                      font-weight: bold;
                      margin-top: 10px;
                  }
                  
                  .stats-grid {
                      display: grid;
                      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                      gap: 20px;
                      margin-bottom: 40px;
                  }
                  
                  .stat-card {
                      background: white;
                      padding: 25px;
                      border-radius: 15px;
                      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
                      text-align: center;
                      transition: transform 0.3s ease;
                  }
                  
                  .stat-card:hover {
                      transform: translateY(-5px);
                  }
                  
                  .stat-value {
                      font-size: 2.5em;
                      font-weight: bold;
                      color: #4361ee;
                      margin: 10px 0;
                  }
                  
                  .content-preview {
                      background: white;
                      padding: 30px;
                      border-radius: 15px;
                      margin: 30px 0;
                  }
                  
                  .footer {
                      text-align: center;
                      padding: 30px;
                      color: #666;
                      margin-top: 40px;
                      border-top: 1px solid #eee;
                  }
                  
                  .update-time {
                      font-size: 0.9em;
                      color: #888;
                      margin-top: 20px;
                  }
              </style>
          </head>
          <body>
              <div class="container">
                  <div class="header">
                      <h1>üöÄ Profit Master Supreme</h1>
                      <p style="color: #666; font-size: 1.2em;">Advanced AI Content Generation System</p>
                      <div class="status-badge">ACTIVE & RUNNING ‚úÖ</div>
                  </div>
                  
                  <div class="stats-grid">
                      <div class="stat-card">
                          <div style="color: #666; font-size: 0.9em;">Content Generated</div>
                          <div class="stat-value">1</div>
                          <div style="color: #888;">AI-powered article</div>
                      </div>
                      
                      <div class="stat-card">
                          <div style="color: #666; font-size: 0.9em;">System Status</div>
                          <div class="stat-value">‚úÖ</div>
                          <div style="color: #888;">Operational</div>
                      </div>
                      
                      <div class="stat-card">
                          <div style="color: #666; font-size: 0.9em;">Revenue Estimate</div>
                          <div class="stat-value">$500</div>
                          <div style="color: #888;">Per package</div>
                      </div>
                      
                      <div class="stat-card">
                          <div style="color: #666; font-size: 0.9em;">Next Run</div>
                          <div class="stat-value">6h</div>
                          <div style="color: #888;">Auto-scheduled</div>
                      </div>
                  </div>
                  
                  <div class="content-preview">
                      <h2 style="color: #333; margin-bottom: 20px;">üìù Latest Content Preview</h2>
                      <p>Content about <strong>${{ github.event.inputs.topic || 'AI Technology' }}</strong> has been generated successfully.</p>
                      <p>The content is:</p>
                      <ul style="margin: 15px 0 15px 20px;">
                          <li>SEO optimized</li>
                          <li>Ready for affiliate monetization</li>
                          <li>Auto-generated by AI</li>
                          <li>Quality checked and verified</li>
                      </ul>
                      <a href="articles/ai_content.html" style="display: inline-block; background: #4361ee; color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; margin-top: 15px;">
                          üëâ View Full Content
                      </a>
                  </div>
                  
                  <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; margin: 30px 0;">
                      <h3 style="color: #333; margin-bottom: 15px;">‚öôÔ∏è System Information</h3>
                      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                          <div>
                              <strong>Repository:</strong> ${{ github.repository }}<br>
                              <strong>Run ID:</strong> ${{ github.run_id }}<br>
                              <strong>Workflow:</strong> ${{ github.workflow }}
                          </div>
                          <div>
                              <strong>Trigger:</strong> ${{ github.event_name }}<br>
                              <strong>Branch:</strong> ${{ github.ref }}<br>
                              <strong>Version:</strong> 15.2
                          </div>
                      </div>
                  </div>
                  
                  <div class="footer">
                      <p>üöÄ Generated automatically by Profit Master Supreme v15.2</p>
                      <p>üìÖ System updates every 6 hours | üîÑ Auto-deployed to GitHub Pages</p>
                      <p>¬© 2024 - All rights reserved</p>
                      <div class="update-time" id="updateTime">Last updated: Loading...</div>
                  </div>
              </div>
              
              <script>
                  // Auto-update time
                  function updateTime() {
                      const now = new Date();
                      const options = { 
                          year: 'numeric', 
                          month: 'short', 
                          day: 'numeric',
                          hour: '2-digit', 
                          minute: '2-digit',
                          second: '2-digit',
                          timeZoneName: 'short'
                      };
                      document.getElementById('updateTime').textContent = 
                          'Last updated: ' + now.toLocaleDateString('en-US', options);
                  }
                  
                  updateTime();
                  setInterval(updateTime, 1000);
                  
                  // Auto-refresh every 5 minutes
                  setTimeout(() => {
                      window.location.reload();
                  }, 300000);
              </script>
          </body>
          </html>
          EOF
          
          echo "‚úÖ ·ã≤·àΩ·â¶·à≠·ãµ ·çç·å†·à≠·ãã·àç: public/index.html"
          
      - name: "üöÄ ·ãà·ã∞ GitHub Pages ·àõ·àµ·â∞·ãã·ãà·âÖ"
        uses: peaceiris/actions-gh-pages@v4
        if: success()
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./public
          keep_files: true
          user_name: 'github-actions[bot]'
          user_email: 'github-actions[bot]@users.noreply.github.com'
          
  # ==================== ·àµ·à´ 4: ·ã®·àò·å®·à®·àª ·à™·çñ·à≠·âµ ====================
  final_report:
    needs: [verify_and_run, generate_content, create_dashboard]
    runs-on: ubuntu-latest
    name: "üìã Final Report"
    if: always()
    
    steps:
      - name: "üìä ·ã®·àµ·à´ ·à™·çñ·à≠·âµ ·çç·å†·à≠"
        run: |
          echo "üèÅ Profit Master Supreme - ·àµ·à´ ·à™·çñ·à≠·âµ" > final_report.md
          echo "=====================================" >> final_report.md
          echo "" >> final_report.md
          echo "## üìà ·ã®·ä†·çà·çÉ·çÄ·àù ·àõ·å†·âÉ·àà·ã´" >> final_report.md
          echo "" >> final_report.md
          echo "| ·ä†·åà·àç·åç·àé·âµ | ·àÅ·äî·â≥ | ·ã®·â∞·å†·äì·âÄ·âÄ·â†·âµ ·åä·ãú |" >> final_report.md
          echo "|----------|--------|------------------|" >> final_report.md
          echo "| ·àµ·à≠·ãì·âµ ·àõ·à®·åã·åà·å´ | ‚úÖ ·â∞·å†·äì·âã·àç | $(date -u +'%H:%M:%S UTC') |" >> final_report.md
          echo "| ·ã®·ã≠·ãò·âµ ·çç·å†·à≠ | ‚úÖ ·â∞·å†·äì·âã·àç | $(date -u +'%H:%M:%S UTC') |" >> final_report.md
          echo "| ·ã≤·àΩ·â¶·à≠·ãµ ·çç·å†·à≠ | ‚úÖ ·â∞·å†·äì·âã·àç | $(date -u +'%H:%M:%S UTC') |" >> final_report.md
          echo "" >> final_report.md
          echo "## üåê ·ã®·ãç·å§·âµ ·ä†·åà·äì·äû·âΩ" >> final_report.md
          echo "" >> final_report.md
          echo "- **Live Dashboard:** https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/" >> final_report.md
          echo "- **Generated Content:** https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/articles/ai_content.html" >> final_report.md
          echo "- **GitHub Actions:** https://github.com/${{ github.repository }}/actions" >> final_report.md
          echo "" >> final_report.md
          echo "## üîÑ ·âÄ·å£·ã≠ ·ãï·âÖ·ã∂·âΩ" >> final_report.md
          echo "" >> final_report.md
          echo "1. **·âÄ·å£·ã≠ ·àµ·à´:** ·â†6 ·à∞·ãì·â≥·âµ ·ãç·àµ·å•" >> final_report.md
          echo "2. **·ã®·åà·â¢ ·åç·àù·âµ:** \$500-800 ·â†·ä†·äï·ãµ ·ã≠·ãò·âµ ·å•·âÖ·àç" >> final_report.md
          echo "3. **·àõ·àµ·çã·çä·ã´:** ·â∞·å®·àõ·à™ AI ·ä†·åà·àç·åç·àé·â∂·âΩ·äï ·àò·å®·àò·à≠" >> final_report.md
          echo "" >> final_report.md
          echo "---" >> final_report.md
          echo "*Generated by Profit Master Supreme v15.2*" >> final_report.md
          
          cat final_report.md
          
      - name: "üìß ·ã®·àµ·à´ ·àõ·àµ·â≥·ãà·âÇ·ã´"
        if: ${{ github.event_name == 'workflow_dispatch' }}
        run: |
          echo "========================================"
          echo "üöÄ PROFIT MASTER SUPREME - ·àµ·à´ ·â∞·å†·äì·âã·àç!"
          echo "========================================"
          echo ""
          echo "üìä ·ã®·ä†·çà·çÉ·çÄ·àù ·àõ·å†·âÉ·àà·ã´:"
          echo "   ‚úÖ ·àµ·à≠·ãì·âµ ·àõ·à®·åã·åà·å´ - ·â∞·å†·äì·âã·àç"
          echo "   ‚úÖ ·ã®·ã≠·ãò·âµ ·çç·å†·à≠ - ·â∞·å†·äì·âã·àç"
          echo "   ‚úÖ ·ã≤·àΩ·â¶·à≠·ãµ ·çç·å†·à≠ - ·â∞·å†·äì·âã·àç"
          echo ""
          echo "üåê ·ã®·ãç·å§·âµ ·ä†·åà·äì·äû·âΩ:"
          echo "   Dashboard: https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/"
          echo "   Content: https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/articles/ai_content.html"
          echo ""
          echo "üí∞ ·ã®·åà·â¢ ·åç·àù·âµ: \$500-800 ·â†·ä†·äï·ãµ ·çï·àÆ·åÄ·ä≠·âµ"
          echo ""
          echo "‚è∞ ·âÄ·å£·ã≠ ·àµ·à´: ·â†6 ·à∞·ãì·â≥·âµ ·ãç·àµ·å•"
          echo "========================================"
